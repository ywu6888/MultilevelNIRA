% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Multilevel_Isingfit.R
\name{Multilevel_Isingfit}
\alias{Multilevel_Isingfit}
\title{Multilevel Ising Network Modeling}
\usage{
Multilevel_Isingfit(
  data,
  group.col = c("city"),
  rnd = list(city = ~1),
  family = "binomial",
  AND = TRUE,
  gamma = 0.25,
  m = 1,
  lambda_grid = NULL,
  nlambda = 100,
  lambda.min.ratio = ifelse(nrow(data) < ncol(data), 0.01, 1e-04),
  plot = TRUE,
  progressbar = TRUE,
  min_sum = -Inf,
  lowerbound.lambda = NA,
  ...
)
}
\arguments{
\item{data}{A data frame or matrix where rows represent observations and columns represent binary (0/1) variables, each variable corresponding to a node.}

\item{group.col}{A character vector specifying the name(s) of the grouping column(s) used to define the multilevel structure. Default is \code{c("city")}.}

\item{rnd}{A list specifying the random-effects structure. Names of list elements correspond to grouping variables, and values are formulas (e.g., \code{~1}). Default is \code{list(city = ~1)}.}

\item{family}{A string specifying the distribution family; currently only \code{"binomial"} is supported. Default is \code{"binomial"}.}

\item{AND}{A logical value indicating whether to use the AND rule to compute the weight (adjacency) matrix. Default is \code{TRUE}.}

\item{gamma}{A numeric value for the EBIC penalty parameter γ, which controls model sparsity. Default is \code{0.25}.}

\item{m}{An integer used to increase λ_max, thereby extending the range of the penalty parameter sequence. Default is \code{1}.}

\item{lambda_grid}{A numeric vector of user-specified penalty parameters λ; if \code{NULL}, the grid is generated automatically.}

\item{nlambda}{An integer specifying the number of points in the automatically generated λ sequence. Default is \code{100}.}

\item{lambda.min.ratio}{A numeric value giving the ratio of minimum λ to maximum λ; a smaller ratio is used when the number of variables exceeds the number of observations. Default is \code{ifelse(nrow(data) < ncol(data), 1e-2, 1e-4)}.}

\item{plot}{A logical value indicating whether to plot the model-selection path. Default is \code{TRUE}.}

\item{progressbar}{A logical value indicating whether to display an iteration progress bar. Default is \code{TRUE}.}

\item{min_sum}{A numeric lower bound on the sum of conditional log-likelihoods for each node; can be used to adjust for extreme samples. Default is \code{-Inf}.}

\item{lowerbound.lambda}{A numeric value to manually set the lower bound for λ; if \code{NA}, the automatically computed lower bound is used. Default is \code{NA}.}
}
\description{
Multilevel Ising Network Modeling
}
\examples{
Multilevel_Isingfit(data, group.col =  c("city"), rnd = list(city = ~1),m=1,nlambda = 100)
}
\author{
Written by Wu Yiming 2025/07/29
MultilevelNIRA
School of Psychology, South China Normal University
}
